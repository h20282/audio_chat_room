# 消息类型

## 接口设计

### 注册请求

example:

```json
{
    "type": "request.regist",
    "userName":"gzh",
    "password":"123"
}
```

### 注册回复

example:

```json
{
    "type": "reply.regist",
    "result":false,
    "msg":"用户名已占用/用户名非法/密码非法",
}
```

### 登录请求

example:

```json
{
    "type": "request.login",
    "userName":"gzh",
    "password":"123"
}
```

### 登录回复

example:

```json
{
    "type": "reply.login",
    "result":false,
    "msg":"密码错误/用户名不存在",
}
```

### 创建房间请求

example:

```json
{
    "type": "request.createRoom",
    "password":"8888"
}
```

### 创建房间回复

example:

```json
{
    "type": "reply.createRoom",
    "roomId":1234
}
```

### 创建房间广播

example:

```json
{
    "type": "boardcast.createRoom",
    "roomId":1234,
    "passwordNeed":true,
    "ownerId":"gzh"
}
```

### 加入房间请求

example:

```json
{
    "type": "request.joinRoom",
    "roomId": 1234,
    "password": "8888"
}
```

### 加入房间回复

example:

```json
{
    "type": "reply.joinRoom",
    "result": false,
    "msg": "密码错误/房间号不存在/你已被禁止加入"
}
```

### 加入房间广播

example:

```json
{
    "type": "boardcast.joinRoom",
    "userId": "gzh"
}
```

### 离开房间请求

房主离开房间时，房主自动转让给下一个用户
example:

```json
{
    "type": "request.leaveRoom"
}
```

### 离开房间回复

example:

```json
{
    "type": "reply.leaveRoom",
    "result": false,
    "msg":"状态错误：尚未加入房间"
}
```

### 离开房间广播

example:

```json
{
    "type": "boardcast.leaveRoom",
    "userId": "gzh"
}
```

### 获取房间列表请求

example:

```json
{
    "type": "request.getRoomList"
}
```

### 获取房间列表回复

example:

```json
{
    "type": "reply.getRoomList",
    "rooms": [
        {
            "roomId": 123,
            "passwordNeed": true,
            "userNum": 3,
            "ownerId": "gzh"
        },
        {
            "roomId": 124,
            "passwordNeed": false,
            "userNum": 3,
            "ownerId": "gzh"
        }
    ]
}
```

### 获取房间成员列表请求

example:

```json
{
    "type": "request.getUserList",
}
```

### 获取房间成员列表回复

example:

```json
{
    "type": ,
    "users": [
        "userId": "gzh",
        "userId": "ys",
        "userId": "fda",
    ]
    "ownerId": "gzh"
}
```

### 转让房主请求

example:

```json
{
    "type": "request.changeOwner",
    "to": "gzh"
}
```

### 转让房主回复

example:

```json
{
    "type": "reply.changeOwner",
    "result": false,
    "msg": "状态错误：未在房间内/用户未找到"
}
```

### 转让房主广播

example:

```json
{
    "type": "boardcast.changeOwner",
    "newOwner": "gzh"
}
```

### 踢出成员请求

example:

```json
{
    "type": "request.kickUser",
    "userId": "gzh"
}
```

### 踢出成员回复

example:

```json
{
    "type": "reply.kickUser",
    "result": false,
    "msg": "用户未找到/权限不足"
}
```

### 踢出成员广播

example:

```json
{
    "type": "boardcast.kickUser",
    "userId": "gzh"
}
```

### 禁言请求

example:

```json
{
    "type": "request.mute",
    "userId": "gzh"
}
```

### 禁言回复

example:

```json
{
    "type": "reply.mute",
    "result": false,
    "msg": "用户未找到/权限不足"
}
```

### 禁言广播

example:

```json
{
    "type": "boardcast.mute",
    "userId": 
}
```

### 文字聊天请求

example:

```json
{
    "type":"request.sendMsg",
    "text":""
}


### 文字聊天广播

example:

```json

{
    "type":"boardcast.sendMsg",
    "user":"456"
    "text":"",
}


## 类设计

### 服务端

```java
interface IUser{
    std::string GetId();
    IConnection GetConnection();
};

interface IConnection{
    Send();
    SigNewMessage();
    SigClose();
}

class Room{
    vector<IUser> users_;
}

class Server{
    vector<Room> rooms_;
}
```

可能的新需求：
可以动态增设密码/清除房间密码
